(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{7892:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>I});var a=t(5155),r=t(2115),l=t(9535);function n(){return(0,l.createBrowserClient)("https://cxzllzyxwpyptfretryc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN4emxsenl4d3B5cHRmcmV0cnljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzNzYxODAsImV4cCI6MjA2Nzk1MjE4MH0.b794GEIWE4ZdMAm9xQYAJ0Gx-XEn1fhJBTIIeTro_1g")}var i=t(1154);function c(e){let{children:s}=e,[t,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[o,x]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0),u=n();async function g(){try{let{data:{user:e}}=await u.auth.getUser();if(!e){window.location.href="/login";return}l(e);let{data:s}=await u.from("profiles").select("*").eq("id",e.id).single();if(s){d(s);let{data:e}=await u.from("dashboard_configs").select("*").eq("role",s.role).single();e&&x({theme:e.config.theme,refreshInterval:e.config.refreshInterval,widgets:e.widgets,layout:e.layout})}}catch(e){console.error("Error loading user config:",e)}finally{h(!1)}}if((0,r.useEffect)(()=>{g()},[]),m)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin text-blue-500"})});let j=(null==o?void 0:o.theme)||"dark";return(0,a.jsxs)("div",{className:"min-h-screen ".concat("dark"===j?"bg-gray-900":"bg-gray-50"," ").concat("dark"===j?"text-white":"text-gray-900"),children:[(0,a.jsx)("nav",{className:"".concat("dark"===j?"bg-gray-800":"bg-white"," shadow-lg"),children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-500 to-purple-600 bg-clip-text text-transparent",children:"Scout Dashboard"}),(0,a.jsxs)("span",{className:"ml-4 text-sm opacity-75",children:[null==c?void 0:c.role.replace("_"," ").toUpperCase()," VIEW"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-sm",children:(null==c?void 0:c.full_name)||(null==c?void 0:c.email)}),(0,a.jsx)("button",{onClick:()=>u.auth.signOut(),className:"text-sm hover:opacity-75",children:"Sign Out"})]})]})})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s})]})}var d=t(3540),o=t(3504),x=t(4754),m=t(6025),h=t(2071),u=t(4021),g=t(2366),j=t(3401),v=t(9429),b=t(170),f=t(8357),y=t(4811),N=t(3109),p=t(8500),w=t(5868),S=t(7580),C=t(7108),F=t(9397),k=t(5339);function A(){let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)([]),[i,c]=(0,r.useState)(!0),[A,I]=(0,r.useState)(""),_=n();async function E(){try{let e=new Date;e.setDate(e.getDate()-30);let{data:t}=await _.from("daily_metrics").select("*").gte("date",e.toISOString()).order("date",{ascending:!0});if(t&&t.length>0){let e=t.reduce((e,s)=>e+Number(s.total_revenue),0),a=t.slice(0,15).reduce((e,s)=>e+Number(s.total_revenue),0),r=t.slice(15).reduce((e,s)=>e+Number(s.total_revenue),0);s({revenue:e,revenueChange:a>0?(r-a)/a*100:0,customerSatisfaction:87.5,projectDeliveryRate:94.2,clientRetention:91.8,creativePerformance:88.9});let n=t.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),revenue:Number(e.total_revenue),transactions:e.total_transactions,avgTransactionValue:Number(e.avg_transaction_value||0)}));l(n)}let{data:a}=await _.from("ai_insights").select("*").eq("insight_type","executive_summary").order("created_at",{ascending:!1}).limit(1).single();a&&I(a.content)}catch(e){console.error("Error loading dashboard data:",e)}finally{c(!1)}}if((0,r.useEffect)(()=>{E()},[]),i)return(0,a.jsx)("div",{className:"animate-pulse",children:"Loading executive insights..."});let D=["#3B82F6","#10B981","#F59E0B","#EF4444"];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Total Revenue"}),(0,a.jsxs)("p",{className:"text-3xl font-bold mt-1",children:["â‚±",(null==e?void 0:e.revenue.toLocaleString())||"0"]}),(0,a.jsx)("div",{className:"flex items-center mt-2",children:(null==e?void 0:e.revenueChange)&&e.revenueChange>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"h-4 w-4 text-green-500 mr-1"}),(0,a.jsxs)("span",{className:"text-green-500 text-sm",children:["+",e.revenueChange.toFixed(1),"%"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"h-4 w-4 text-red-500 mr-1"}),(0,a.jsxs)("span",{className:"text-red-500 text-sm",children:[null==e?void 0:e.revenueChange.toFixed(1),"%"]})]})})]}),(0,a.jsx)(w.A,{className:"h-8 w-8 text-blue-500"})]})}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Customer Satisfaction"}),(0,a.jsxs)("p",{className:"text-3xl font-bold mt-1",children:[null==e?void 0:e.customerSatisfaction,"%"]}),(0,a.jsx)("p",{className:"text-green-500 text-sm mt-2",children:"+2.3% from last month"})]}),(0,a.jsx)(S.A,{className:"h-8 w-8 text-green-500"})]})}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Project Delivery Rate"}),(0,a.jsxs)("p",{className:"text-3xl font-bold mt-1",children:[null==e?void 0:e.projectDeliveryRate,"%"]}),(0,a.jsx)("p",{className:"text-yellow-500 text-sm mt-2",children:"3 projects at risk"})]}),(0,a.jsx)(C.A,{className:"h-8 w-8 text-yellow-500"})]})}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Creative Performance"}),(0,a.jsxs)("p",{className:"text-3xl font-bold mt-1",children:[null==e?void 0:e.creativePerformance,"%"]}),(0,a.jsx)("p",{className:"text-purple-500 text-sm mt-2",children:"Above industry avg"})]}),(0,a.jsx)(F.A,{className:"h-8 w-8 text-purple-500"})]})})]}),A&&(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,a.jsx)(k.A,{className:"h-5 w-5 mr-2 text-blue-500"}),"Executive AI Summary"]}),(0,a.jsx)("p",{className:"text-gray-300 leading-relaxed",children:A})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Revenue Trend (30 Days)"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(d.u,{width:"100%",height:"100%",children:(0,a.jsxs)(o.b,{data:t,children:[(0,a.jsx)(x.d,{strokeDasharray:"3 3",stroke:"#374151"}),(0,a.jsx)(m.W,{dataKey:"date",stroke:"#9CA3AF"}),(0,a.jsx)(h.h,{stroke:"#9CA3AF"}),(0,a.jsx)(u.m,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelStyle:{color:"#F3F4F6"}}),(0,a.jsx)(g.N,{type:"monotone",dataKey:"revenue",stroke:"#3B82F6",strokeWidth:2,dot:{fill:"#3B82F6"}})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Transaction Volume"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(d.u,{width:"100%",height:"100%",children:(0,a.jsxs)(j.E,{data:t.slice(-7),children:[(0,a.jsx)(x.d,{strokeDasharray:"3 3",stroke:"#374151"}),(0,a.jsx)(m.W,{dataKey:"date",stroke:"#9CA3AF"}),(0,a.jsx)(h.h,{stroke:"#9CA3AF"}),(0,a.jsx)(u.m,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelStyle:{color:"#F3F4F6"}}),(0,a.jsx)(v.y,{dataKey:"transactions",fill:"#10B981"})]})})})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Category Distribution"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(d.u,{width:"100%",height:"100%",children:(0,a.jsxs)(b.r,{children:[(0,a.jsx)(f.F,{data:[{name:"Electronics",value:35},{name:"Groceries",value:25},{name:"Fashion",value:20},{name:"Other",value:20}],cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",children:[0,1,2,3].map((e,s)=>(0,a.jsx)(y.f,{fill:D[s%D.length]},"cell-".concat(s)))}),(0,a.jsx)(u.m,{})]})})})]})]})]})}function I(){let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)(!0),d=n();async function o(){try{let{data:{user:e}}=await d.auth.getUser();if(!e){window.location.href="/login";return}let{data:t}=await d.from("profiles").select("*").eq("id",e.id).single();t&&s(t)}catch(e){console.error("Error loading profile:",e)}finally{l(!1)}}return((0,r.useEffect)(()=>{o()},[]),t)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin text-blue-500"})}):(0,a.jsx)(c,{children:(()=>{switch(null==e?void 0:e.role){case"executive":return(0,a.jsx)(A,{});case"regional_manager":return(0,a.jsx)("div",{children:"Regional Manager Dashboard (Coming Soon)"});case"analyst":return(0,a.jsx)("div",{children:"Analyst Dashboard (Coming Soon)"});case"store_owner":return(0,a.jsx)("div",{children:"Store Owner Dashboard (Coming Soon)"});default:return(0,a.jsx)("div",{children:"No dashboard available for your role"})}})()})}},8499:(e,s,t)=>{Promise.resolve().then(t.bind(t,7892))}},e=>{e.O(0,[222,182,441,964,358],()=>e(e.s=8499)),_N_E=e.O()}]);